# PDF 交互式提取 SVG/PNG 工具

一个使用 Tkinter + PyMuPDF 构建的桌面小工具，可在 PDF 页上交互选区并导出：
- 精确裁剪的 `SVG`
- 指定 `DPI` 的 `PNG`
- 批量导出多尺寸的 `PNG/WEBP/JPG/ICO`（支持 CairoSVG 渲染，缺省回退到 PyMuPDF）

## 功能概览
- 打开 PDF、分页预览，支持上一页/下一页切换
- 鼠标拖拽选择区域，支持自由/固定比例（预设 `1:1`, `4:3`, `3:2`, `16:9`, `9:16`），也可自定义比例 `W:H` 或单值比例
- 导出 SVG：严格以选区裁剪，保持选区大小作为画布尺寸
- 导出 PNG：可设置 `DPI`（默认 300），按选区裁剪
- 批量导出图片：按较长边尺寸批量导出多格式（PNG/WEBP/JPG/ICO），可输入自定义尺寸列表
- 导出过程显示进度与日志，自动处理 CairoSVG 不可用时的回退策略

## 环境与依赖
- Python 3.9+（建议）
- 依赖包：
  - 必需：`PyMuPDF`（`pymupdf`）、`Pillow`
  - 可选：`CairoSVG`（提升 SVG 渲染质量与兼容性）

安装示例：
```bash
pip install pymupdf pillow
# 可选安装（推荐）：
pip install cairosvg
```

## 运行方式
```bash
python pdf_svg_gui.py
```

## 使用指南
1. 打开 PDF：点击工具栏中的“打开PDF”选择文件
2. 页面浏览：使用“上一页/下一页”切换并在画布查看预览
3. 选区与比例：
   - 鼠标拖拽在画布上框选区域
   - 选择“选框比例”为自由/预设；若需自定义，输入 `W:H`（如 `3:2`）或单值比例（如 `1.5`）
4. 导出：
   - SVG：点击“导出SVG”，生成精确裁剪的矢量文件
   - PNG：设置 DPI 后点击“导出PNG”，生成栅格图片
   - 批量导出图片：点击“批量导出图片”，勾选格式与尺寸（含自定义，逗号分隔），选择输出目录，等待进度完成

## 说明与提示
- 若未安装 CairoSVG，批量导出将自动回退到 PyMuPDF 渲染（质量可能略有差异）
- 批量导出时，按选区原始宽高比缩放，`target` 作为较长边尺寸
- ICO 导出支持最大 `256x256`，超过该尺寸会跳过该条目
- 大体积 PDF 或极高 DPI 可能占用较多内存，请酌情配置
- Windows 下可能看到 CRLF/LF 提示，属正常 Git 文本换行提示

## 文件结构
```
.
└── pdf_svg_gui.py
```

## 版权与许可
未明确指定许可；如需开源许可证，请在本文件或仓库中补充。